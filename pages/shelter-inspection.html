<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ski-Track - Inspection d'abri</title>
  <link rel="stylesheet" href="../css/main.css">
  <script src="../js/common.js"></script>
</head>



<body>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üèîÔ∏è</text></svg>">
  
  <header class="header">
    <nav class="nav">
      <div class="nav-logo">Ski-Track</div>
      <div class="nav-links">
        <a href="../index.html">Tableau de bord</a>
        <a href="trail-inspection.html">Rapport piste</a>
        <a href="shelter-inspection.html" class="active">Rapport abri</a>
        <a href="inspection-history.html">Historique</a>
        <a href="status.html">Public</a>
        <a href="admin.html" id="admin-link" style="display: none;">Admin</a>
        <a href="change-password.html">MdP</a>
        <a href="#" id="login-link">Connexion</a>
      </div>
      <button class="mobile-menu-btn" id="mobile-menu-btn">‚ò∞</button>
    </nav>
    
    <!-- Structure du menu mobile -->
    <div class="mobile-nav" id="mobile-nav">
      <div class="mobile-nav-header">
        <div class="logo">Ski-Track</div>
        <button class="mobile-nav-close" id="mobile-nav-close">‚úï</button>
      </div>
      <div class="mobile-nav-links">
        <a href="../index.html">Tableau de bord</a>
        <a href="trail-inspection.html">Rapport piste</a>
        <a href="shelter-inspection.html" class="active">Rapport abri</a>
        <a href="inspection-history.html">Historique</a>
        <a href="status.html">Public</a>
        <a href="admin.html" id="mobile-admin-link" style="display: none;">Admin</a>
        <a href="change-password.html" id="mobile-password-link">MdP</a>
        <a href="#" id="mobile-login-link">Connexion</a>
      </div>
    </div>
  </header>
  
  <!-- Loading screen -->
  <div id="loading" class="loading-screen">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <p>V√©rification de l'authentification...</p>
    </div>
  </div>
  
  <!-- Main content -->
  <div id="main-content" class="main" style="display: none;">
    <div class="page-header">
      <h1 class="page-title">Inspection d'abri</h1>
      <div class="page-actions">
        <button class="btn btn-secondary" id="cancel-btn">
          ‚Üê Retour au tableau de bord
        </button>
      </div>
    </div>
    
    <div class="content-section">
      <div class="card">
        <form class="inspection-form" id="shelter-inspection-form">
          <!-- General Information Section -->
          <div class="form-section">
            <div class="form-section-header">
              <h2 class="form-section-title">üìç Informations g√©n√©rales</h2>
            </div>
            <div class="form-section-body">
              <div class="form-grid">
                <div class="form-group">
                  <label class="form-label form-label-required" for="shelter-select">Abri</label>
                  <select class="form-control" id="shelter-select" required>
                    <option value="">S√©lectionner un abri</option>
                    <!-- Options loaded dynamically -->
                  </select>
                </div>
                
                <div class="form-group">
                  <label class="form-label" for="inspector-name">Inspecteur</label>
                  <input type="text" class="form-control" id="inspector-name" readonly>
                  <input type="hidden" id="inspector-id" name="inspector-id">
                </div>
                
                <div class="form-group">
                  <label class="form-label form-label-required" for="inspection-date">Date d'inspection</label>
                  <input type="date" class="form-control" id="inspection-date" required>
                </div>
                
                <div class="form-group">
                  <label class="form-label form-label-required" for="inspection-time">Heure d'inspection</label>
                  <input type="time" class="form-control" id="inspection-time" required>
                </div>
              </div>
            </div>
          </div>

          <!-- Shelter Condition Section -->
          <div class="form-section">
            <div class="form-section-header">
              <h2 class="form-section-title">üè† √âtat g√©n√©ral de l'abri</h2>
            </div>
            <div class="form-section-body">
              <div class="form-grid">
                <div class="form-group">
                  <label class="form-label form-label-required">√âtat g√©n√©ral</label>
                  <div class="radio-group">
                    <div class="radio-item">
                      <input type="radio" id="condition-good" name="condition" value="good" class="form-radio">
                      <label for="condition-good" class="radio-label">
                        <span class="radio-indicator good"></span>
                        <span class="radio-text">Bon √©tat</span>
                      </label>
                    </div>
                    <div class="radio-item">
                      <input type="radio" id="condition-warning" name="condition" value="warning" class="form-radio">
                      <label for="condition-warning" class="radio-label">
                        <span class="radio-indicator warning"></span>
                        <span class="radio-text">Attention requise</span>
                      </label>
                    </div>
                    <div class="radio-item">
                      <input type="radio" id="condition-critical" name="condition" value="critical" class="form-radio">
                      <label for="condition-critical" class="radio-label">
                        <span class="radio-indicator critical"></span>
                        <span class="radio-text">√âtat critique</span>
                      </label>
                    </div>
                  </div>
                </div>
                
                <div class="form-group">
                  <label class="form-label">Propret√©</label>
                  <div class="radio-group">
                    <div class="radio-item">
                      <input type="radio" id="cleanliness-good" name="cleanliness" value="good" class="form-radio">
                      <label for="cleanliness-good" class="radio-label">
                        <span class="radio-indicator good"></span>
                        <span class="radio-text">Propre</span>
                      </label>
                    </div>
                    <div class="radio-item">
                      <input type="radio" id="cleanliness-warning" name="cleanliness" value="warning" class="form-radio">
                      <label for="cleanliness-warning" class="radio-label">
                        <span class="radio-indicator warning"></span>
                        <span class="radio-text">Moyennement propre</span>
                      </label>
                    </div>
                    <div class="radio-item">
                      <input type="radio" id="cleanliness-critical" name="cleanliness" value="critical" class="form-radio">
                      <label for="cleanliness-critical" class="radio-label">
                        <span class="radio-indicator critical"></span>
                        <span class="radio-text">Sale</span>
                      </label>
                    </div>
                  </div>
                </div>

                <div class="form-group">
                  <label class="form-label">Accessibilit√©</label>
                  <div class="radio-group">
                    <div class="radio-item">
                      <input type="radio" id="accessibility-good" name="accessibility" value="good" class="form-radio">
                      <label for="accessibility-good" class="radio-label">
                        <span class="radio-indicator good"></span>
                        <span class="radio-text">D√©gag√©</span>
                      </label>
                    </div>
                    <div class="radio-item">
                      <input type="radio" id="accessibility-warning" name="accessibility" value="warning" class="form-radio">
                      <label for="accessibility-warning" class="radio-label">
                        <span class="radio-indicator warning"></span>
                        <span class="radio-text">Partiellement obstru√©</span>
                      </label>
                    </div>
                    <div class="radio-item">
                      <input type="radio" id="accessibility-critical" name="accessibility" value="critical" class="form-radio">
                      <label for="accessibility-critical" class="radio-label">
                        <span class="radio-indicator critical"></span>
                        <span class="radio-text">Bloqu√©</span>
                      </label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Detailed Assessment Section -->
          <div class="form-section">
            <div class="form-section-header">
              <h2 class="form-section-title">üîç √âvaluation d√©taill√©e</h2>
            </div>
            <div class="form-section-body">
              <div class="form-grid">
                <div class="form-group">
                  <label class="form-label" for="cleanliness-details">D√©tails sur la propret√©</label>
                  <textarea class="form-control" id="cleanliness-details" 
                           placeholder="D√©crivez l'√©tat de propret√© de l'abri..." 
                           rows="3"></textarea>
                </div>
                
                <div class="form-group">
                  <label class="form-label" for="accessibility-details">D√©tails sur l'accessibilit√©</label>
                  <textarea class="form-control" id="accessibility-details" 
                           placeholder="D√©crivez l'√©tat du chemin d'acc√®s et de l'entr√©e..." 
                           rows="3"></textarea>
                </div>
              </div>
            </div>
          </div>

          <!-- Issues Section -->
          <div class="form-section">
            <div class="form-section-header">
              <h2 class="form-section-title">‚ö†Ô∏è Probl√®mes identifi√©s</h2>
            </div>
            <div class="form-section-body">
              <div class="issues-container">
                <div class="issues-checkboxes">
                  <div class="checkbox-group">
                    <div class="checkbox-item">
                      <input type="checkbox" id="issue-cleanliness" value="Probl√®mes de propret√©" class="form-checkbox">
                      <label for="issue-cleanliness" class="checkbox-label"><span class="checkbox-indicator"></span>Probl√®mes de propret√©</label>
                    </div>
                    <div class="checkbox-item">
                      <input type="checkbox" id="issue-access" value="Acc√®s difficile" class="form-checkbox">
                      <label for="issue-access" class="checkbox-label"><span class="checkbox-indicator"></span>Acc√®s difficile</label>
                    </div>
                  </div>
                </div>
                
                <div class="form-group">
                  <label class="form-label" for="other-issues">Autres probl√®mes</label>
                  <textarea class="form-control" id="other-issues" 
                           placeholder="D√©crivez tout autre probl√®me non list√© ci-dessus..." 
                           rows="3"></textarea>
                </div>
              </div>
            </div>
          </div>

          <!-- Photos Section -->
          <div class="form-section">
            <div class="form-section-header">
              <h2 class="form-section-title">üì∑ Documentation photographique</h2>
            </div>
            <div class="form-section-body">
              <div class="form-group">
                <div class="file-upload-area" id="photo-upload">
                  <div class="file-upload-content">
                    <div class="file-upload-icon">üì∑</div>
                    <p class="file-upload-text">D√©posez des photos ici ou cliquez pour parcourir</p>
                    <p class="file-upload-hint">Format accept√©: JPG, PNG ‚Ä¢ Taille max: 10 MB par photo</p>
                  </div>
                  <input type="file" id="file-input" multiple accept="image/*" class="file-input-hidden">
                </div>
                
                <div class="photo-preview-container" id="preview-container">
                  <!-- Photo previews will be added here dynamically -->
                </div>
              </div>
            </div>
          </div>

          <!-- Additional Details Section -->
          <div class="form-section">
            <div class="form-section-header">
              <h2 class="form-section-title">üìù Commentaires additionnels</h2>
            </div>
            <div class="form-section-body">
              <div class="form-group">
                <label class="form-label" for="comments">Commentaires g√©n√©raux et observations</label>
                <textarea class="form-control" id="comments" 
                         placeholder="Ajoutez des commentaires d√©taill√©s, observations particuli√®res, recommandations pour l'entretien..." 
                         rows="4"></textarea>
              </div>
            </div>
          </div>

          <!-- Form Actions -->
          <div class="form-actions">
            <button type="button" class="btn btn-secondary" id="cancel-action">
              Annuler
            </button>
            <button type="submit" class="btn btn-primary" id="submit-btn">
              Enregistrer l'inspection
            </button>
          </div>

          <!-- Status Messages -->
          <div class="status-messages">
            <div id="success-message" class="alert alert-success" style="display: none;"></div>
            <div id="error-message" class="alert alert-danger" style="display: none;"></div>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-storage-compat.js"></script>
  
  <script src="../js/auth.js"></script>
  <script src="../js/mobile-menu.js"></script>
  <script src="../js/shelter-inspection.js"></script>
</body>
</html>